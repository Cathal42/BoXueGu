<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>学IT - 后台管理系统</title>
  <?php include '/common/css.html'?>
</head>
<body>
<!-- 登录 -->
<div class="login">
  <div class="login-wrap">
    <div class="avatar">
      <img src="/public/uploads/monkey.png" class="img-circle" alt="">
    </div>
    <form id="formLogin" action="" class="col-md-offset-1 col-md-10">
      <div class="input-group input-group-lg">
                    <span class="input-group-addon">
                        <i class="fa fa-user"></i>
                    </span>
        <input type="text" name="tc_name" class="form-control" placeholder="用户名">
      </div>
      <div class="input-group input-group-lg">
                    <span class="input-group-addon">
                        <i class="fa fa-key"></i>
                    </span>
        <input type="password" name="tc_pass" class="form-control" placeholder="密码">
      </div>
      <button type="submit" class="btn btn-lg btn-primary btn-block">登 录</button>
    </form>
  </div>
</div>

<?php include '/common/script.html'?>
<script>
  $('#formLogin').on('click', function () {
    var data = $(this).serializeArray();
    $.ajax({
      type: 'post',
      url: '/api/login',
      data: data,
      beforeSend: function () {
        if (data[0].value === '' || data[1].value === '') {
          return false;
        }
      },
      success: function (data) {
        if (data.code === 200) {
          // 将服务器返回的用户头像及用户名信息存入cookie,cookie只存储字符串,故需将传回的json对象转换成字符串
          // 默认cookie有效路径为创建cookie的网页所在的路径，在这里为'/index.php'，为使在整个网站中有效，将其设置为'/'
          $.cookie('userInfo', JSON.stringify(data.result), {path: '/'});
          //登录成功,跳转到主页
          window.location.href = '/index.php';
        }
      },
      error: function () {
        alert('登录失败');
      }
    });
    return false;
  });
</script>
</body>
</html>